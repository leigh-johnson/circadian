extends ../layout

block content
  div(ng-app='locationApp')
    div(ng-controller='LocationCtrl')
      .jumbotron
        .container
            .row
              h1.text-center Fetching current location...
            .row.well
              .col-xs-4
                img.img-thumbnail(src='/images/allow-location.jpg')
                .caption.text-center Press "Allow"
              .col-xs-8
                h3 This demonstration requires your geolocation for the best possible experience.
            .row 
              .col-xs-12
                h1.text-center Privacy concerns? 
                h3.text-center: small No problem. Manually set a location below.
                p.text-center: small The location you set will be stored in a cookie.
              .col-xs-12
                .well.input-group#searchbox
                  span#setLocationSubmit.btn.btn-primary.input-group-addon(type='button' ng-click='$apply()') Set Location
              .col-xs-12
                ui-gmap-google-map(center='map.center' zoom='map.zoom')
                  ui-gmap-search-box(events='searchbox.events' template='searchbox.template' parentdiv='searchbox.parentdiv')
                  ui-gmap-marker(coords="marker.coords" options="marker.options" events="marker.events" idkey="marker.id")

append head-js
  //script.
    navigator.geolocation.getCurrentPosition(function(position){
      window.location.search = '?lat='+ position.coords.latitude + '&long=' +position.coords.longitude;
      });
  script(src='//maps.googleapis.com/maps/api/js?sensor=false&libraries=places')
